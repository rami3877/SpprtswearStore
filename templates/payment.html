<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/css/payment.css">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <link href='https://fonts.googleapis.com/css?family=Akronim' rel='stylesheet'>

    <title>Payment</title>
</head>

<body>
    <main class="container">
        <header>
            <h1>
                <div>
                    <p class="logo"> SS </p>
                </div>
                <div class="header-title">
                    <i class='bx bx-cart'></i> Shopping cart
                </div>
            </h1>
        </header>
        <div class="item-flex">
            <!-- checkout section -->
            <section class="checkout">
                <h2 class="section-heading">Payment Details</h2>
                <div class="payment-form">
                    <div class="payment-method">
                        <button class="method">
                            <div>
                                <i class='bx bxl-visa'></i>
                                <span>Visa Card</span>
                            </div>
                            <div><i class='bx bxs-check-circle' id="checking"></i></div>
                        </button>

                        <button class="method2">
                            <a href="https://www.paypal.com/signin" target="_blank" rel="noopener noreferrer">
                                <div>
                                    <i class='bx bxl-paypal'></i>
                                    <span>PayPal</span>
                                </div>
                                <div><i class='bx bx-check-circle' id="checking"></i></div>
                            </a>
                        </button>

                        <button class="method3">
                            <span>**** **** **** *759</span>
                            <div><i class='bx bx-check-circle' id="checking"></i></div>
                        </button>
                    </div>
                    <div>
                        <div class="cardholder-name">
                            <label for="cardholder-name" class="label-default">Cardholder name</label>
                            <input type="text" name="cardholder-name" id="cardholder-name" class="input-default"
                                placeholder="Cardholder name">
                        </div>
                        <div class="mobile-number">
                            <label for="mobile-number" class="label-default"> Mobile number </label>
                            <input type="number" name="mobile-number" min="0" id="mobile-number" class="input-default"
                                placeholder="07**">
                        </div>

                        <div class="address">
                            <div class="input-group">
                                <div class="input-item">
                                    <label for="city" class="label-default">City</label>
                                    <input type="text" name="city" id="city" class="input-default" placeholder="City">
                                </div>

                                <div class="input-item">
                                    <label for="street" class="label-default">Street</label>
                                    <input type="text" name="street" id="street" class="input-default"
                                        placeholder="Street">
                                </div>
                            </div>

                            <div class="input-group">
                                <div class="input-item">
                                    <label for="apartment" class="label-default">Apartment Number</label>
                                    <input type="text" name="apartment" id="apartment" class="input-default"
                                        placeholder="Apartment Number">
                                </div>
                                <div class="input-item">
                                    <label for="building" class="label-default">Building Number</label>
                                    <input type="text" name="building" id="building" class="input-default"
                                        placeholder="Building Number">
                                </div>

                                <div class="Visa_number">
                                    <label for="Visa_number" class="label-default"> Visa number </label>
                                    <input type="number" min="0" name="Visa_number" id="Visa_number"
                                        class="input-default" placeholder="**** **** **** ****">
                                </div>
                                <div class="input-flex">
                                    <div class="expire-date" id="expirydate">
                                        <span class="label-default">Expiration date</span>

                                        <div class="input-flex">
                                            <input type="number" name="day" placeholder="31" min="1" max="31"
                                                class="input-default" id="day">
                                            /
                                            <input type="number" name="month" placeholder="12" min="1" max="12"
                                                class="input-default" id="month">
                                        </div>
                                    </div>

                                    <div class="cvv">
                                        <label for="cvv" class="label-default"> CVV</label>
                                        <input type="number" name="cvv" id="cvv" min="0" class="input-default"
                                            placeholder="* * *">
                                    </div>
                                </div>

                            </div>
                    <script>
                        class apiFecth {
                            static json(method_, path, callback, stringdata) {
                                fetch(path, {
                                    method: method_,
                                    body: stringdata,
                                    headers: {
                                        "Content-Type": "application/json",
                                    },
                                }).then(re => re.json()).then((data) => {
                                    callback(data)
                                })
                            }
                            static Get(path, callback) {
                                fetch(path, { method: "GET" }).then(re => re.json()).then((data) => { callback(data) })
                            }
                            static From(method_, path, callback, stringdata) {
                                fetch(path, {
                                    method: method_, body: stringdata, headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                                }).then(re => re.json()).then((data) => { callback(data) })
                            }
                        }

                        apiFecth.Get("/user/name", (data) => {
                            document.getElementById("cardholder-name").value = data
                        })
                        apiFecth.Get("/user/phone", (data) => {
                            document.getElementById("mobile-number").value = data
                        })
                        apiFecth.Get("/user/addr", (data) => {
                            if (data.city.length == 0) {
                                return
                            } else if (data.street.length == 0) {
                                return
                            } else if (data.apartment == 0) {
                                return
                            } else if (data.building == 0) {
                                return
                            }
                        })

                    </script>
                </div>

                <div class="pay-btn-width" >
                    <!-- onclick="posproduct()" -->
                    <button class="pay-btn" onclick="PostVisa()">
<<<<<<< HEAD
                        <b >Pay</b> $<span id="payamount" >0</span>
                    </button >
=======
                        <b>Pay</b> $<span id="payamount">0</span>
                    </button>
>>>>>>> beb469b2fdc40db0cf219a3937b9a57bf1959a5b
                </div>


                <!-- cart section -->
                <section class="cart">
                    <div class="cart-border" id="cart-border">
                        <h2 class="section-heading">Order Product</h2>
                        <div class="total" id="totalBefor">
                            <span>Total:</span> <span>$<span id="total">0</span></span>
                        </div>
                </section>
        </div>
    </main>

    <script>
        var Order = new Map()
        class ProductCookie {
            constructor(product) {
                this.id = product.id
                this.whereIform = product.whereIform
                this.price = product.price
                this.Description = product.Description
                this.color = product.color
                this.size = product.size
                this.img = product.img
                this.qty = product.qty
                this.elementHtml = document.createElement("div")
                this.elementHtml.setAttribute("class", "product-card")
                this.elementHtml.innerHTML = ` 
                        <div class="card">
                            <div class="img-box">
                                <img src="${this.img}"alt="SS Product" width="90px" class="product-img">
                            </div>
                            <div class="detail">
                                <h4 class="product-name">${this.Description}</h4>
                                <div class="wrapper">
                                    <div class="product-qty">
                                        <button id="decrement">
                                            <i class='bx bx-minus' id="bx-minus" ></i>
                                        </button>
                                        <span id="quantity">${this.qty}</span>
                                        <button id="increment">
                                            <i class='bx bx-plus' id="bx-plus"></i>
                                        </button>
                                    </div>
                                    <div class="price">
                                        $<span id="price">${this.price}</span>
                                    </div>
                                </div>
                            </div>
                            <button id="product-delete-btn">
                                <i class='bx bxs-trash'></i>
                            </button>
                        </div> `
                this.elementHtml.querySelector("#bx-minus").addEventListener("click", e => {
                    if (this.qty == 1) {
                        return
                    }
                    this.qty--
                    let total = Number(document.getElementById("total").textContent) - this.price
                    document.getElementById("payamount").textContent = Number(document.getElementById("payamount").textContent) - this.price
                    this.elementHtml.querySelector("#quantity").textContent = this.qty
                    document.getElementById("total").textContent = total

                })
                this.elementHtml.querySelector("#bx-plus").addEventListener("click", e => {
                    document.getElementById("total").textContent = Number(document.getElementById("total").textContent) + this.price
                    document.getElementById("payamount").textContent = Number(document.getElementById("payamount").textContent) + this.price
                    this.qty++
                    this.elementHtml.querySelector("#quantity").textContent = this.qty
                })
                this.elementHtml.querySelector("#product-delete-btn").addEventListener("click", e => {
                    let total = Number(document.getElementById("total").textContent) - (this.qty * this.price)
                    document.getElementById("payamount").textContent = Number(document.getElementById("payamount").textContent) - this.price * this.qty
                    document.getElementById("total").textContent = total
                    this.elementHtml.remove()
                    for (let i = 0; i < Order[this.whereIform].length; i++) {
                        if (Order[this.whereIform][i] == this) {
                            Order[this.whereIform].splice(i, 1)
                        }
                    }
                    let json = JSON.stringify(Order)
                    setCookie("cart", json, 344, "/")
                })

                document.getElementById("cart-border").insertBefore(this.elementHtml, document.getElementById("totalBefor"))
                document.getElementById("total").textContent = Number(document.getElementById("total").textContent) + this.price * this.qty
                document.getElementById("payamount").textContent = Number(document.getElementById("payamount").textContent) + this.price * this.qty
            }
            qtyChange() {
                this.qty++
                document.getElementById("total").textContent = Number(document.getElementById("total").textContent) + this.price
                document.getElementById("payamount").textContent = Number(document.getElementById("payamount").textContent) + this.price * this.qty
                this.elementHtml.querySelector("#input").value = Number(this.elementHtml.querySelector("#input").value) + 1
                let json = JSON.stringify(Order)
                setCookie("cart", json, 344, "/")

            }

        }

        function getCookieValue(name) {
            const regex = new RegExp(`(^| )${name}=([^;]+)`)
            const match = document.cookie.match(regex)
            if (match) {
                return match[2]
            }
        }

        if (getCookieValue("cart").length != 0) {
            let cookieCart = JSON.parse(getCookieValue("cart"))
            let cart = document.getElementById("cart-contant")
            for (const cartC in cookieCart) {
                let NewArry = [];
                for (const f of Object.values(cookieCart[cartC])) {
                    NewArry[NewArry.length] = new ProductCookie(f);
                }
                Order[cartC] = NewArry;

            }


        }
        function setCookie(name, value, days, path) {
            const data = new Date();
            data.setTime(data.getTime() + (days * 24 * 60 * 60 * 1000))
            let expires = "expires=" + data.toUTCString();
            document.cookie = `${name}=${value};${expires};path=${path}`
        }

        function deleteCookie(name) {
            setCookie(name, null, null)
        }





    </script>
    <script src="/js/payment.js"></script>
</body>

</html>


<!-- <div class="product-card">
                        <div class="card">
                            <div class="img-box">
                                <img src="https://th.bing.com/th/id/OIP._fzHbaZBweLph0QE7tJ6FAAAAA?rs=1&pid=ImgDetMain"
                                 alt="SS Product" width="90px" class="product-img">
                            </div>
                            <div class="detail">
                                <h4 class="product-name">Camiseta Originals</h4>
                                <div class="wrapper">
                                    <div class="product-qty">
                                        <button id="decrement">
                                            <i class='bx bx-minus'></i>
                                        </button>
                                        <span id="quantity">1</span>
                                        <button id="increment">
                                            <i class='bx bx-plus'></i>
                                        </button>
                                    </div>
                                    <div class="price">
                                        $<span id="price">37</span>
                                    </div>
                                </div>
                            </div>
                            <button id="product-delete-btn">
                                <i class='bx bxs-trash'></i>
                            </button>
                        </div>
                    </div> -->